/*
 * This Kotlin source file was generated by the Gradle 'init' task.
 */
package sample

fun calculateScore(input: String) = convertToFrames(input).sumOf { it.score }

private fun convertToFrames(input: String): List<Frame> {
    val stringFrames = input.replace('-', '0').split("||", "|")

    return (0..9).map {
        val frame = stringFrames[it]

        if (frame == "X") {
            val firstRoll = 10
            val nextFrame = stringFrames[it + 1]
            var firstBonusRoll: Int
            var secondBonusRoll: Int

            if (nextFrame == "X") {
                val secondNextFrame = stringFrames[it + 2]
                firstBonusRoll = 10
                secondBonusRoll = if (secondNextFrame == "X") 10 else secondNextFrame[0].digitToInt()
            } else {
                val bonusRolls = getRollsScores(nextFrame)
                firstBonusRoll = bonusRolls.first
                secondBonusRoll = bonusRolls.second
            }

            Frame(firstRoll, firstBonusRoll = firstBonusRoll, secondBonusRoll = secondBonusRoll)
        } else {
            val (firstRoll, secondRoll) = getRollsScores(frame)

            Frame(firstRoll, secondRoll)
        }
    }
}

private fun getRollsScores(frame: String): Pair<Int, Int> = Pair(frame[0].digitToInt(), frame[1].digitToInt())
